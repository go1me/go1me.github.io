<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://go1me.github.io/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://go1me.github.io/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://go1me.github.io/css/github.min.css' />
    <link rel="stylesheet" href='https://go1me.github.io/css/github-style.css' />
    <link rel="stylesheet" href='https://go1me.github.io/css/light.css' />
    <link rel="stylesheet" href='https://go1me.github.io/css/dark.css' />
    <link rel="stylesheet" href='https://go1me.github.io/css/syntax.css' />
    <title>一道逆向题ROR的writeup - go1me&#39;s 博客</title>
    
    <link rel="icon" type="image/x-icon" href='/images/github.png'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="11月20日的时候，参加了西湖论剑CTF线上初选赛，此为此次竞赛REVERS第三题的wirteup，该题题目为ROR。
查看文件类型  使用file文件查看文件类型，发现文件为32位exe文件
使用IDA打开exe文件  使用32位IDA打开然后打开字符串页面发现有flag字符串
跳过去代码是这样的
代码走查 代码第37行接收输入Dst;
代码第38行判断输入字符长度是否为40;
代码第39到46行（截图没截全）是通过输入Dst通过某种变换得到Buf2;
代码第47行是比较Buf2和unk_405100内存中的内容;
代码第53行提示如果47行内存内容相同则输入的Dst就是flag，flag长度为40个字符。
公式变换 关键就是30行到46行，现在的写法比较不好理解，我们稍微转换一下*(&amp;amp;v2&#43;j)其实就是v2[j]，以此类推得出如下公式:
for ( i = 0; i &amp;lt; 0x28; i &#43;= 8 ) { for ( j = 0; j &amp;lt; 8; &#43;&#43;j ) { v0=((v2[j]&amp;amp;v16[i])&amp;lt;&amp;lt;(8-(3- j)%8))|((v2[j]&amp;amp;v16[i])&amp;gt;&amp;gt;(3-j)%8)|((v2[j]&amp;amp;v15[i])&amp;lt;&amp;lt;(8-(2-j)%8))|((v2[j]&amp;amp;v15[i])&amp;gt;&amp;gt;(2 - j)%8)|((v2[j]&amp;amp;v14[i])&amp;lt;&amp;lt;(8-(1-j)%8))|((v2[j]&amp;amp;v14[i])&amp;gt;&amp;gt;(1-j)%8)|((v2[j]&amp;amp;Dst[i])&amp;lt;&amp;lt;(8-(0-j)%8))|((v2[j]&amp;amp;Dst[i])&amp;gt;&amp;gt;(0-j)%8); Buf2[j &#43; i] = byte_405000[((v2[j]&amp;amp;v20[i])&amp;lt;&amp;lt;(8-(7-j)%8))|((v2[j]&amp;amp;v20[i])&amp;gt;&amp;gt;(7 - j)%8)|((v2[j]&amp;amp;v19[i])&amp;lt;&amp;lt;(8-(6-j)%8))|((v2[j]&amp;amp;v19[i])&amp;gt;&amp;gt;(6-j)%8)|((v2[j]&amp;amp;v18[i])&amp;lt;&amp;lt;(8-(5-j)%8))|((v2[j]&amp;amp;v18[i])&amp;gt;&amp;gt;(5-j)%8)|((v2[j]&amp;amp;v17[i])&amp;lt;&amp;lt;(8-(4-j)%8)|((v2[j]&amp;amp;v17[i])&amp;gt;&amp;gt;(4-j)%8)|v0)]; } } 其中有一个重复的结构(v2[j]&amp;amp;v16[i])&amp;laquo;(8-(3- j)%8))|((v2[j]&amp;amp;v16[i])&amp;raquo;(3-j)%8)，可以百度一下，这个就是ROR算法，循环右移。
因此上面的长长的公式可以再变化：
for ( i = 0; i &amp;lt; 0x28; i &#43;= 8 ) { for ( j = 0; j &amp;lt; 8; &#43;&#43;j ) { v0= ROR(v2[j]&amp;amp;v16[i],(3-j)%8)|ROR(v2[j]&amp;amp;v15[i],(2-j)%8)|ROR(v2[j]&amp;amp;v14[i],(1-j)%8)|ROR(v2[j]&amp;amp;Dst[i],(0-j)%8); Buf2[j &#43; i] = byte_405000[ROR(v2[j]&amp;amp;v20[i],(7-j)%8)|ROR(v2[j]&amp;amp;v19[i],(6-j)%8)|ROR(v2[j]&amp;amp;v18[i],(5-j)%8)|ROR(v2[j]&amp;amp;v17[i],(4-j)%8)|v0]; } } 其中ROR为循环右移函数。" />
<meta name="keywords"
  content='blog, google analytics' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://go1me.github.io/post/%E4%B8%80%E9%81%93%E9%80%86%E5%90%91%E9%A2%98ror%E7%9A%84writeup/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="一道逆向题ROR的writeup - go1me&#39;s 博客" />
<meta name="twitter:description"
  content="11月20日的时候，参加了西湖论剑CTF线上初选赛，此为此次竞赛REVERS第三题的wirteup，该题题目为ROR。
查看文件类型  使用file文件查看文件类型，发现文件为32位exe文件
使用IDA打开exe文件  使用32位IDA打开然后打开字符串页面发现有flag字符串
跳过去代码是这样的
代码走查 代码第37行接收输入Dst;
代码第38行判断输入字符长度是否为40;
代码第39到46行（截图没截全）是通过输入Dst通过某种变换得到Buf2;
代码第47行是比较Buf2和unk_405100内存中的内容;
代码第53行提示如果47行内存内容相同则输入的Dst就是flag，flag长度为40个字符。
公式变换 关键就是30行到46行，现在的写法比较不好理解，我们稍微转换一下*(&amp;amp;v2&#43;j)其实就是v2[j]，以此类推得出如下公式:
for ( i = 0; i &amp;lt; 0x28; i &#43;= 8 ) { for ( j = 0; j &amp;lt; 8; &#43;&#43;j ) { v0=((v2[j]&amp;amp;v16[i])&amp;lt;&amp;lt;(8-(3- j)%8))|((v2[j]&amp;amp;v16[i])&amp;gt;&amp;gt;(3-j)%8)|((v2[j]&amp;amp;v15[i])&amp;lt;&amp;lt;(8-(2-j)%8))|((v2[j]&amp;amp;v15[i])&amp;gt;&amp;gt;(2 - j)%8)|((v2[j]&amp;amp;v14[i])&amp;lt;&amp;lt;(8-(1-j)%8))|((v2[j]&amp;amp;v14[i])&amp;gt;&amp;gt;(1-j)%8)|((v2[j]&amp;amp;Dst[i])&amp;lt;&amp;lt;(8-(0-j)%8))|((v2[j]&amp;amp;Dst[i])&amp;gt;&amp;gt;(0-j)%8); Buf2[j &#43; i] = byte_405000[((v2[j]&amp;amp;v20[i])&amp;lt;&amp;lt;(8-(7-j)%8))|((v2[j]&amp;amp;v20[i])&amp;gt;&amp;gt;(7 - j)%8)|((v2[j]&amp;amp;v19[i])&amp;lt;&amp;lt;(8-(6-j)%8))|((v2[j]&amp;amp;v19[i])&amp;gt;&amp;gt;(6-j)%8)|((v2[j]&amp;amp;v18[i])&amp;lt;&amp;lt;(8-(5-j)%8))|((v2[j]&amp;amp;v18[i])&amp;gt;&amp;gt;(5-j)%8)|((v2[j]&amp;amp;v17[i])&amp;lt;&amp;lt;(8-(4-j)%8)|((v2[j]&amp;amp;v17[i])&amp;gt;&amp;gt;(4-j)%8)|v0)]; } } 其中有一个重复的结构(v2[j]&amp;amp;v16[i])&amp;laquo;(8-(3- j)%8))|((v2[j]&amp;amp;v16[i])&amp;raquo;(3-j)%8)，可以百度一下，这个就是ROR算法，循环右移。
因此上面的长长的公式可以再变化：
for ( i = 0; i &amp;lt; 0x28; i &#43;= 8 ) { for ( j = 0; j &amp;lt; 8; &#43;&#43;j ) { v0= ROR(v2[j]&amp;amp;v16[i],(3-j)%8)|ROR(v2[j]&amp;amp;v15[i],(2-j)%8)|ROR(v2[j]&amp;amp;v14[i],(1-j)%8)|ROR(v2[j]&amp;amp;Dst[i],(0-j)%8); Buf2[j &#43; i] = byte_405000[ROR(v2[j]&amp;amp;v20[i],(7-j)%8)|ROR(v2[j]&amp;amp;v19[i],(6-j)%8)|ROR(v2[j]&amp;amp;v18[i],(5-j)%8)|ROR(v2[j]&amp;amp;v17[i],(4-j)%8)|v0]; } } 其中ROR为循环右移函数。" />
<meta name="twitter:site" content="https://go1me.github.io/" />
<meta name="twitter:creator" content="go1me" />
<meta name="twitter:image"
  content="https://go1me.github.io/">


<meta property="og:type" content="article" />
<meta property="og:title" content="一道逆向题ROR的writeup - go1me&#39;s 博客">
<meta property="og:description"
  content="11月20日的时候，参加了西湖论剑CTF线上初选赛，此为此次竞赛REVERS第三题的wirteup，该题题目为ROR。
查看文件类型  使用file文件查看文件类型，发现文件为32位exe文件
使用IDA打开exe文件  使用32位IDA打开然后打开字符串页面发现有flag字符串
跳过去代码是这样的
代码走查 代码第37行接收输入Dst;
代码第38行判断输入字符长度是否为40;
代码第39到46行（截图没截全）是通过输入Dst通过某种变换得到Buf2;
代码第47行是比较Buf2和unk_405100内存中的内容;
代码第53行提示如果47行内存内容相同则输入的Dst就是flag，flag长度为40个字符。
公式变换 关键就是30行到46行，现在的写法比较不好理解，我们稍微转换一下*(&amp;amp;v2&#43;j)其实就是v2[j]，以此类推得出如下公式:
for ( i = 0; i &amp;lt; 0x28; i &#43;= 8 ) { for ( j = 0; j &amp;lt; 8; &#43;&#43;j ) { v0=((v2[j]&amp;amp;v16[i])&amp;lt;&amp;lt;(8-(3- j)%8))|((v2[j]&amp;amp;v16[i])&amp;gt;&amp;gt;(3-j)%8)|((v2[j]&amp;amp;v15[i])&amp;lt;&amp;lt;(8-(2-j)%8))|((v2[j]&amp;amp;v15[i])&amp;gt;&amp;gt;(2 - j)%8)|((v2[j]&amp;amp;v14[i])&amp;lt;&amp;lt;(8-(1-j)%8))|((v2[j]&amp;amp;v14[i])&amp;gt;&amp;gt;(1-j)%8)|((v2[j]&amp;amp;Dst[i])&amp;lt;&amp;lt;(8-(0-j)%8))|((v2[j]&amp;amp;Dst[i])&amp;gt;&amp;gt;(0-j)%8); Buf2[j &#43; i] = byte_405000[((v2[j]&amp;amp;v20[i])&amp;lt;&amp;lt;(8-(7-j)%8))|((v2[j]&amp;amp;v20[i])&amp;gt;&amp;gt;(7 - j)%8)|((v2[j]&amp;amp;v19[i])&amp;lt;&amp;lt;(8-(6-j)%8))|((v2[j]&amp;amp;v19[i])&amp;gt;&amp;gt;(6-j)%8)|((v2[j]&amp;amp;v18[i])&amp;lt;&amp;lt;(8-(5-j)%8))|((v2[j]&amp;amp;v18[i])&amp;gt;&amp;gt;(5-j)%8)|((v2[j]&amp;amp;v17[i])&amp;lt;&amp;lt;(8-(4-j)%8)|((v2[j]&amp;amp;v17[i])&amp;gt;&amp;gt;(4-j)%8)|v0)]; } } 其中有一个重复的结构(v2[j]&amp;amp;v16[i])&amp;laquo;(8-(3- j)%8))|((v2[j]&amp;amp;v16[i])&amp;raquo;(3-j)%8)，可以百度一下，这个就是ROR算法，循环右移。
因此上面的长长的公式可以再变化：
for ( i = 0; i &amp;lt; 0x28; i &#43;= 8 ) { for ( j = 0; j &amp;lt; 8; &#43;&#43;j ) { v0= ROR(v2[j]&amp;amp;v16[i],(3-j)%8)|ROR(v2[j]&amp;amp;v15[i],(2-j)%8)|ROR(v2[j]&amp;amp;v14[i],(1-j)%8)|ROR(v2[j]&amp;amp;Dst[i],(0-j)%8); Buf2[j &#43; i] = byte_405000[ROR(v2[j]&amp;amp;v20[i],(7-j)%8)|ROR(v2[j]&amp;amp;v19[i],(6-j)%8)|ROR(v2[j]&amp;amp;v18[i],(5-j)%8)|ROR(v2[j]&amp;amp;v17[i],(4-j)%8)|v0]; } } 其中ROR为循环右移函数。" />
<meta property="og:url" content="https://go1me.github.io/post/%E4%B8%80%E9%81%93%E9%80%86%E5%90%91%E9%A2%98ror%E7%9A%84writeup/" />
<meta property="og:site_name" content="一道逆向题ROR的writeup" />
<meta property="og:image"
  content="https://go1me.github.io/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2021-12-03 20:10:19 &#43;0800 CST" />










</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://go1me.github.io/">
        <svg class="octicon" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://go1me.github.io/">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://go1me.github.io/">
        <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
          width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>
  
<script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="https://unpkg.com/tippy.js@6"></script>
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://go1me.github.io/">
                  <img class=" avatar-user"
                    src="https://go1me.github.io/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://go1me.github.io/">go1me</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://go1me.github.io/post/%E4%B8%80%E9%81%93%E9%80%86%E5%90%91%E9%A2%98ror%E7%9A%84writeup/">一道逆向题ROR的writeup</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Fri, 03 Dec 2021 20:10:19 &#43;0800"
                    class="no-wrap">
                    Fri, 03 Dec 2021 20:10:19 &#43;0800</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Wed, 22 Jun 2022 00:11:31 &#43;0800"
                    class="no-wrap">
                    Wed, 22 Jun 2022 00:11:31 &#43;0800</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" class="btn btn-octicon m-0 mr-2 p-2" aria-haspopup="menu" aria-label="Table of Contents" role="button">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                          1360 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/ctf">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      ctf
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/revers">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      revers
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/writeup">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      writeup
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5">
                <article class="markdown-body entry-content container-lg"><p>  11月20日的时候，参加了西湖论剑CTF线上初选赛，此为此次竞赛REVERS第三题的wirteup，该题题目为ROR。</p>
<h1 id="查看文件类型">查看文件类型</h1>
<p>  使用file文件查看文件类型，发现文件为32位exe文件<br>
<img src="/images/2021120301.png" alt="1"></p>
<h1 id="使用ida打开exe文件">使用IDA打开exe文件</h1>
<p>  使用32位IDA打开然后打开字符串页面发现有flag字符串<br>
<img src="/images/2021120302.png" alt="2"><br>
跳过去代码是这样的<br>
<img src="/images/2021120303.png" alt="3"></p>
<h1 id="代码走查">代码走查</h1>
<p>代码第37行接收输入Dst;<br>
代码第38行判断输入字符长度是否为40;<br>
代码第39到46行（截图没截全）是通过输入Dst通过某种变换得到Buf2;<br>
代码第47行是比较Buf2和unk_405100内存中的内容;<br>
代码第53行提示如果47行内存内容相同则输入的Dst就是flag，flag长度为40个字符。</p>
<h1 id="公式变换">公式变换</h1>
<p>关键就是30行到46行，现在的写法比较不好理解，我们稍微转换一下*(&amp;v2+j)其实就是v2[j]，以此类推得出如下公式:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0x28</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v0</span><span class="o">=</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v16</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span> <span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v16</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v15</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v15</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v14</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v14</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">);</span>
      <span class="n">Buf2</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_405000</span><span class="p">[((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v20</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">7</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v20</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">7</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v19</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v19</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v18</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">))</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v18</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v17</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v17</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">v0</span><span class="p">)];</span>
    <span class="p">}</span>
  <span class="p">}</span>

</code></pre></div><p>其中有一个重复的结构(v2[j]&amp;v16[i])&laquo;(8-(3- j)%8))|((v2[j]&amp;v16[i])&raquo;(3-j)%8)，可以百度一下，这个就是ROR算法，循环右移。<br>
<img src="/images/2021120304.png" alt="4"><br>
因此上面的长长的公式可以再变化：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0x28</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
  <span class="p">{</span>
	<span class="n">v0</span><span class="o">=</span> <span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v16</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">3</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v15</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">2</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v14</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">1</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">0</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">);</span>
	<span class="n">Buf2</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_405000</span><span class="p">[</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v20</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">7</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v19</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">6</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v18</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">5</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">v17</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">v0</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>其中ROR为循环右移函数。<br>
在看看v14到v20是什么东东，其实v14=Dst[1], v15=Dst[2]，v16=Dst[3], v17=Dst[4]， v18=Dst[5], v19=Dst[6],v20=Dst[7]<br>
注意，v2是int型，因此v2[0]=0x80,v2[1]=0x40,v2[2]=0x20,v2[3]=0x10,v2[4]=0x8,v2[5]=0x4,v2[6]=0x2,v2[7]=0x1<br>
<img src="/images/2021120305.png" alt="5"><br>
上面的公式再变化：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0x28</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
  <span class="p">{</span>
	<span class="n">v0</span><span class="o">=</span> <span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">3</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">2</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">1</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">0</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">);</span>
	<span class="n">Buf2</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_405000</span><span class="p">[</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">7</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">7</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">6</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">6</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">5</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">5</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">],(</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">v0</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>大致可以看出这两个for循环是把Dst每8个一组搞事情<br>
当i=0时<br>
当j=0时</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="n">v0</span><span class="o">=</span> <span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">);</span>
<span class="n">Buf2</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_405000</span><span class="p">[</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="mi">7</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="mi">5</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x80</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="mi">4</span><span class="p">)</span><span class="o">|</span><span class="n">v0</span><span class="p">];</span>
</code></pre></div><p>相当于把Dst[0]最高位循环右移0位，Dst[1]的最高位循环右移1位，Dst[2]的最高位循环右移2位……，然后或起来<br>
当j=1时</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="n">v0</span><span class="o">=</span> <span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">);</span>
<span class="n">Buf2</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_405000</span><span class="p">[</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="mi">6</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="mi">5</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="mi">4</span><span class="p">)</span><span class="o">|</span><span class="n">ROR</span><span class="p">(</span><span class="mh">0x40</span><span class="o">&amp;</span><span class="n">Dst</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span><span class="o">|</span><span class="n">v0</span><span class="p">];</span>
</code></pre></div><p>相当于把Dst[0]最高次位循环右移7位，Dst[1]的次高位循环右移0位，Dst[2]的次高位循环右移1位……，然后或起来,依此类推</p>
<h1 id="逻辑分析">逻辑分析</h1>
<p>这个过程用文字描述有些晦涩，画个图：<br>
<img src="/images/2021120306.png" alt="6">
如上图，相当于把Dst的每8个字节一组的每一个字节的bit拆出来，按照图中的逻辑组成新的字节作为下标取byte_405000数组中的值。<br>
那么我们把byte_405000的小标拿出来把每个char字符大散成bit然后按照这个逻辑逆序重新拼装回去就是原始输入Dst的值，也就是flag。<br>
通过如下代码段可知，byte_405000内的内容 变换位置后于unk_405100内的内容相等，即可以通过unk_405100反查byte_405000下标序列<br>
<img src="/images/2021120307.png" alt="7"><br>
内存中405000及405100中的内容是已知的<br>
<img src="/images/2021120308.png" alt="8"><br>
且ROR的逆序是ROL（循环左移）</p>
<h1 id="解题代码">解题代码</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">byte_405000</span><span class="o">=</span><span class="p">[</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0xBC</span><span class="p">,</span><span class="mh">0xC3</span><span class="p">,</span><span class="mh">0xCF</span><span class="p">,</span><span class="mh">0xB8</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x7B</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xD5</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0xBD</span><span class="p">,</span><span class="mh">0x9F</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span>
            <span class="mh">0x77</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0xD4</span><span class="p">,</span><span class="mh">0xD7</span><span class="p">,</span><span class="mh">0xEB</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x89</span><span class="p">,</span><span class="mh">0x5E</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x7D</span><span class="p">,</span><span class="mh">0xF4</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span>
            <span class="mh">0xAD</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x2A</span><span class="p">,</span><span class="mh">0x9D</span><span class="p">,</span><span class="mh">0x7F</span><span class="p">,</span><span class="mh">0xD2</span><span class="p">,</span><span class="mh">0xE1</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span><span class="mh">0x8B</span><span class="p">,</span><span class="mh">0x1D</span><span class="p">,</span><span class="mh">0x5A</span><span class="p">,</span><span class="mh">0x91</span><span class="p">,</span><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x94</span><span class="p">,</span>
            <span class="mh">0xF9</span><span class="p">,</span><span class="mh">0x0C</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0xCA</span><span class="p">,</span><span class="mh">0xE8</span><span class="p">,</span><span class="mh">0xCB</span><span class="p">,</span><span class="mh">0x5F</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0xF6</span><span class="p">,</span><span class="mh">0xF0</span><span class="p">,</span><span class="mh">0x3C</span><span class="p">,</span><span class="mh">0xDE</span><span class="p">,</span><span class="mh">0xDA</span><span class="p">,</span><span class="mh">0xEA</span><span class="p">,</span><span class="mh">0x9C</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span>
            <span class="mh">0x75</span><span class="p">,</span><span class="mh">0xA4</span><span class="p">,</span><span class="mh">0x0D</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x58</span><span class="p">,</span><span class="mh">0xFC</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x6B</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0x9A</span><span class="p">,</span><span class="mh">0x6D</span><span class="p">,</span><span class="mh">0xD1</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x98</span><span class="p">,</span>
            <span class="mh">0x68</span><span class="p">,</span><span class="mh">0x2D</span><span class="p">,</span><span class="mh">0x52</span><span class="p">,</span><span class="mh">0x3D</span><span class="p">,</span><span class="mh">0xDD</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0xD6</span><span class="p">,</span><span class="mh">0xD0</span><span class="p">,</span><span class="mh">0xA2</span><span class="p">,</span><span class="mh">0xED</span><span class="p">,</span><span class="mh">0xA5</span><span class="p">,</span><span class="mh">0x3B</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x3E</span><span class="p">,</span><span class="mh">0xF2</span><span class="p">,</span><span class="mh">0x22</span><span class="p">,</span>
            <span class="mh">0x06</span><span class="p">,</span><span class="mh">0xF3</span><span class="p">,</span><span class="mh">0x1A</span><span class="p">,</span><span class="mh">0xA8</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0xDC</span><span class="p">,</span><span class="mh">0x7C</span><span class="p">,</span><span class="mh">0x4B</span><span class="p">,</span><span class="mh">0x5C</span><span class="p">,</span><span class="mh">0x1E</span><span class="p">,</span><span class="mh">0xA1</span><span class="p">,</span><span class="mh">0xB0</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0xE2</span><span class="p">,</span><span class="mh">0x9B</span><span class="p">,</span>
            <span class="mh">0xB7</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x4E</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0xD8</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0xB4</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x7E</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0xF8</span><span class="p">,</span><span class="mh">0x0A</span><span class="p">,</span><span class="mh">0x13</span><span class="p">,</span>
            <span class="mh">0xE3</span><span class="p">,</span><span class="mh">0xE4</span><span class="p">,</span><span class="mh">0xE6</span><span class="p">,</span><span class="mh">0x1C</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x2C</span><span class="p">,</span><span class="mh">0xB1</span><span class="p">,</span><span class="mh">0xEC</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0xA9</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0xBB</span><span class="p">,</span><span class="mh">0xD3</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span>
            <span class="mh">0x39</span><span class="p">,</span><span class="mh">0xE7</span><span class="p">,</span><span class="mh">0xC9</span><span class="p">,</span><span class="mh">0xCE</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x6C</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0xD9</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x3F</span><span class="p">,</span><span class="mh">0x62</span><span class="p">,</span>
            <span class="mh">0xCD</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x07</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x8A</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0xAA</span><span class="p">,</span><span class="mh">0xAC</span><span class="p">,</span><span class="mh">0x2E</span><span class="p">,</span><span class="mh">0xA3</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span><span class="mh">0x7A</span><span class="p">,</span><span class="mh">0xB5</span><span class="p">,</span>
            <span class="mh">0x8E</span><span class="p">,</span><span class="mh">0x69</span><span class="p">,</span><span class="mh">0x1F</span><span class="p">,</span><span class="mh">0x6A</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x3A</span><span class="p">,</span><span class="mh">0xB2</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xAB</span><span class="p">,</span><span class="mh">0xE0</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0xC0</span><span class="p">,</span><span class="mh">0xB3</span><span class="p">,</span><span class="mh">0xBE</span><span class="p">,</span><span class="mh">0xCC</span><span class="p">,</span>
            <span class="mh">0xC6</span><span class="p">,</span><span class="mh">0x2B</span><span class="p">,</span><span class="mh">0x5B</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0xEE</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x4D</span><span class="p">,</span><span class="mh">0x0F</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x4A</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x0B</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span>
            <span class="mh">0x5D</span><span class="p">,</span><span class="mh">0x6F</span><span class="p">,</span><span class="mh">0x4C</span><span class="p">,</span><span class="mh">0xB9</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0xFD</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x8D</span><span class="p">,</span><span class="mh">0x27</span><span class="p">,</span><span class="mh">0xC1</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0x4F</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0xC8</span><span class="p">,</span>
            <span class="mh">0x0E</span><span class="p">,</span><span class="mh">0x8C</span><span class="p">,</span><span class="mh">0xE5</span><span class="p">,</span><span class="mh">0x9E</span><span class="p">,</span><span class="mh">0xAE</span><span class="p">,</span><span class="mh">0xBF</span><span class="p">,</span><span class="mh">0xEF</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0xC5</span><span class="p">,</span><span class="mh">0xAF</span><span class="p">,</span><span class="mh">0xA0</span><span class="p">,</span><span class="mh">0xC2</span><span class="p">,</span><span class="mh">0xFA</span><span class="p">,</span><span class="mh">0xC7</span><span class="p">,</span><span class="mh">0xB6</span><span class="p">,</span><span class="mh">0xDB</span><span class="p">,</span>
            <span class="mh">0x18</span><span class="p">,</span><span class="mh">0xC4</span><span class="p">,</span><span class="mh">0xA6</span><span class="p">,</span><span class="mh">0xFE</span><span class="p">,</span><span class="mh">0xE9</span><span class="p">,</span><span class="mh">0xF5</span><span class="p">,</span><span class="mh">0x6E</span><span class="p">,</span><span class="mh">0x64</span><span class="p">,</span><span class="mh">0x2F</span><span class="p">,</span><span class="mh">0xF1</span><span class="p">,</span><span class="mh">0x1B</span><span class="p">,</span><span class="mh">0xFB</span><span class="p">,</span><span class="mh">0xBA</span><span class="p">,</span><span class="mh">0xA7</span><span class="p">,</span><span class="mh">0x37</span><span class="p">,</span><span class="mh">0x8F</span><span class="p">]</span>     
<span class="n">unk_405100</span><span class="o">=</span><span class="p">[</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x24</span><span class="p">,</span><span class="mh">0x36</span><span class="p">,</span><span class="mh">0x9D</span><span class="p">,</span><span class="mh">0x71</span><span class="p">,</span><span class="mh">0xB8</span><span class="p">,</span><span class="mh">0xC8</span><span class="p">,</span>
            <span class="mh">0x65</span><span class="p">,</span><span class="mh">0xFB</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0x7F</span><span class="p">,</span><span class="mh">0x9A</span><span class="p">,</span><span class="mh">0x9C</span><span class="p">,</span><span class="mh">0xB1</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span>
            <span class="mh">0x65</span><span class="p">,</span><span class="mh">0x8F</span><span class="p">,</span><span class="mh">0x9D</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x8F</span><span class="p">,</span><span class="mh">0x11</span><span class="p">,</span><span class="mh">0xF6</span><span class="p">,</span><span class="mh">0x8E</span><span class="p">,</span>
            <span class="mh">0x65</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0xDA</span><span class="p">,</span><span class="mh">0xB4</span><span class="p">,</span><span class="mh">0x8C</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0xFB</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span>
            <span class="mh">0x65</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x6A</span><span class="p">,</span><span class="mh">0xCA</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0xE7</span><span class="p">,</span><span class="mh">0xA4</span><span class="p">,</span><span class="mh">0x79</span><span class="p">]</span>           
<span class="n">v2</span><span class="o">=</span><span class="p">[</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x8</span><span class="p">,</span><span class="mh">0x4</span><span class="p">,</span><span class="mh">0x2</span><span class="p">,</span><span class="mh">0x1</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">ROL</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
    <span class="n">tmp</span><span class="o">=</span><span class="nb">bin</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s2">&#34;0&#34;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
    <span class="n">index_list</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">40</span>
    <span class="n">flag</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">40</span>
    <span class="k">for</span> <span class="n">ri</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unk_405100</span><span class="p">)):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">ri</span><span class="o">//</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">ri</span><span class="o">%</span><span class="mi">8</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">byte_405000</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">unk_405100</span><span class="p">[</span><span class="n">ri</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
            <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">f</span><span class="p">]</span><span class="o">|=</span><span class="n">ROL</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">&amp;</span><span class="n">index</span><span class="p">,(</span><span class="n">f</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">flag_str</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">flag_str</span> <span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">flag_str</span><span class="p">)</span>
</code></pre></div><h1 id="flag">flag</h1>
<p><img src="/images/2021120309.png" alt="9"><br>
Flag为DASCTF{Q5la5_3KChtem6_HYHk_NlHhNZz73aCZeK05II96}</p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script>
 
 
 
 window.onload = function () {
   const header = document.getElementById('post-header');
   const headerHeight = header.offsetHeight;
   
   document.documentElement.style.scrollPaddingTop = headerHeight + 10 + "px";
 }

 const tocToggleButton = document.getElementById("toc-toggle");

 const tippyInstance = tippy('#toc-toggle', {
  trigger: 'click',
  content: '<div id="table-of-contents">\u003cnav id=\u0022TableOfContents\u0022\u003e\u003c\/nav\u003e</div>',
  allowHTML: true,
  placement: 'bottom-start',
  interactive: true,
  arrow: false,
  maxWidth: "none",
  onHide: function () { tocToggleButton.classList.remove("hover"); },
  onShow: function () { tocToggleButton.classList.add("hover"); },
  onShown: function () {
    selectTableOfContentsOption();

    if (window.hasSetupTableOfContentsListeners) {
      return;
    }

    const tableOfContents = document.getElementById("table-of-contents");
    tableOfContents.addEventListener('click', function () {
      
      tippyInstance[0].hide();
    });

    window.hasSetupTableOfContentsListeners = true;
  }
 });

 function selectTableOfContentsOption () {
   const optionSelectedClass = 'table-of-contents-option-selected';

   const tableOfContentsOptions = document.querySelectorAll("#table-of-contents > nav > ul li");

   for (const option of tableOfContentsOptions) {
     

     const [child] = option.children;
     if (child.tagName.toLowerCase() !== 'a') {
       continue;
     }

     if (window.location.href === child.href) {
       child.classList.add(optionSelectedClass);
     } else {
       child.classList.remove(optionSelectedClass);
     }
   }
 }

 window.onhashchange = selectTableOfContentsOption;
</script>


  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://go1me.github.io/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://go1me.github.io/js/github-style.js"></script>



</html>